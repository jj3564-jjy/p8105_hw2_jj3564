---
title: "p8105_hw2_jj3564"
output: github_document
date: "2025-10-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(readxl)
library(knitr)

```
# Problem 0

This homework uses GitHub, R Projects, and R Markdown for reproducibility. All data files are stored in the `data/` sub directory, and relative paths are used.

# Problem 1

## data cleaning first 

```{r}
## load data
pols_df = read_csv("data/fivethirtyeight_datasets/pols-month.csv")

## clean data
pols_cleaned = pols_df |> 
  separate('mon', into = c("year", "month", "day"), sep = "-", convert = TRUE) |> 
  mutate(
      month = month.name[month],
      president = case_when(
      prez_dem == 1 ~ "dem",
      prez_gop == 1 ~ "gop",
      TRUE ~ NA_character_
    )
  ) |> 
  select(-prez_gop,-prez_dem, -day) |> 
  select (year, month, president, everything())
  
pols_cleaned
```

The pols-month.csv dataset contained monthly political control data, including presidential party affiliation (prez_gop/prez_dem) and the distribution of governorships and congressional seats, starting from 1947. 

## Clean snp.csv data

```{r}
## load data
snp_df = read_csv("data/fivethirtyeight_datasets/snp.csv")

## clean data
snp_cleaned = snp_df |> 
  separate(date, into = c("month_num", "day", "year_short"), sep = "/", convert = TRUE)  |> 

  mutate(
    year = case_when(
      year_short <= 49 ~ year_short + 2000,
      year_short >= 50 ~ year_short + 1900,
    ),
    month = month.name[month_num]
  )  |>  
  select(year, month, snp_value = close) |> 
    # arrange by year and month
  arrange(year, month)

snp_cleaned
```



### Clean `unemployment.csv`
This dataset is in wide format, with months as columns. We pivot it into long format and ensure the month variable matches the same names as before

```{r}
## load data
unemployment_df = read_csv("data/fivethirtyeight_datasets/unemployment.csv")

## tidy data
unemployment_cleaned = unemployment_df |> 
  rename(year = Year) |> 
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |> 
mutate(
    month = month.name[match(month, month.abb)]
) |> 
select(year, month, unemployment) |> 
arrange(year, month)

unemployment_cleaned
```



### Merge datasets
We merge `pols` with `snp`, then merge unemployment.

```{r merge-data}
mergesum_df = pols_cleaned |> 
  left_join(snp_cleaned, by = c("year", "month")) |> 
  left_join(unemployment_cleaned, by = c("year", "month"))

mergesum_df
final_dim = dim(mergesum_df)
final_years = range(mergesum_df$year)
final_names = names(mergesum_df)

mergesum_df
```

**Summary**: The `pols` dataset contains information about political party control. The `snp` dataset contains S&P stock market closing values. The `unemp` dataset contains unemployment percentages. After merging, we have `r merged_summary$n_obs` observations, spanning `r merged_summary$min_year` to `r merged_summary$max_year`. Key variables: `year`, `month`, `president`, `close` (S&P index), and `unemployment`.


# Problem 2: Trash Wheel Data



### Clean Mr. Trash Wheel
```{r trash-wheel}

mr_trash <- read_excel(-"data/202509 Trash Wheel Collection Data.xlsx",  sheet = "Mr. Trash Wheel",
  range = cell_cols("A:N")) %>%
janitor::clean_names() %>%
filter(!is.na(dumpster)) %>%
mutate(
    sports_balls = as.integer(round(sports_balls, 0)),
    year = as.numeric(year),    
    wheel = "Mr. Trash Wheel")
```


### Clean Professor Trash Wheel
```{r}
prof_trash <- read_excel("data/202509 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1) %>%
clean_names() %>%
filter(!is.na(dumpster)) %>%
mutate(sports_balls = as.integer(round(sports_balls,0)), wheel = "Professor")
```


### Clean Gwynnda
```{r}
gwynnda <- read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "Gwynnda", skip = 1) %>%
clean_names() %>%
filter(!is.na(dumpster)) %>%
mutate(sports_balls = as.integer(round(sports_balls,0)), wheel = "Gwynnda")


trash_all <- bind_rows(mr_trash, prof_trash, gwynnda)
```


### Summary statistics
```{r trash-summary}
n_obs <- nrow(trash_all)
total_prof_weight <- sum(filter(trash_all, wheel == "Professor")$weight_tons, na.rm = TRUE)
gwynnda_cigs_jun22 <- trash_all %>% filter(wheel == "Gwynnda", month == 6, year == 2022) %>%
summarize(total = sum(cigarette_butts, na.rm = TRUE)) %>% pull(total)


n_obs; total_prof_weight; gwynnda_cigs_jun22
```


**Summary**: The combined dataset has `r n_obs` observations. Key variables include dumpster ID, collection date, trash weight, and item counts. Professor Trash Wheel collected `r round(total_prof_weight,1)` tons of trash in total. Gwynnda collected `r gwynnda_cigs_jun22` cigarette butts in June 2022.
```



